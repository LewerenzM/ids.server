* put file01.dat

2016-11-02 15:14:24,827 INFO [http-listener-2(2)] IdsService - creating IdsService
2016-11-02 15:14:24,827 INFO [http-listener-2(2)] IdsService - created IdsService
2016-11-02 15:14:24,831 INFO [http-listener-2(2)] IdsBean - creating IdsBean
2016-11-02 15:14:24,833 INFO [http-listener-2(2)] IdsBean - created IdsBean
2016-11-02 15:14:24,833 INFO [http-listener-2(2)] IdsBean - New webservice request: put name='file01.dat' datafileFormatId='914992' datasetId='915165' description='null' doi='null' datafileCreateTime='null' datafileModTime='null'
2016-11-02 15:14:24,887 DEBUG [http-listener-2(2)] LockManager - Acquired a SHARED lock on 915165.
2016-11-02 15:15:06,984 DEBUG [http-listener-2(2)] IdsBean - Registered datafile for dataset 915165 for file01.dat at 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159
2016-11-02 15:15:07,001 INFO [http-listener-2(2)] FiniteStateMachine - Requesting WRITE of datafile 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159
2016-11-02 15:15:07,002 DEBUG [http-listener-2(2)] FiniteStateMachine - Created marker /srv/ids/storage/no-icat/cache/marker/915166
2016-11-02 15:15:07,012 DEBUG [http-listener-2(2)] Transmitter - Sent jms message put 134.30.210.106
2016-11-02 15:15:07,013 DEBUG [http-listener-2(2)] LockManager$SingleLock - Released a lock on 915165.

* put file02.dat

2016-11-02 15:14:24,819 INFO [http-listener-2(1)] IdsBean - New webservice request: put name='file02.dat' datafileFormatId='914992' datasetId='915165' description='null' doi='null' datafileCreateTime='null' datafileModTime='null'
2016-11-02 15:14:24,882 DEBUG [http-listener-2(1)] LockManager - Acquired a SHARED lock on 915165.
2016-11-02 15:16:38,108 DEBUG [http-listener-2(1)] IdsBean - Registered datafile for dataset 915165 for file02.dat at 915061/915165/9c4c0780-6ac7-44a0-bd9c-7525afd80c50
2016-11-02 15:16:38,130 INFO [http-listener-2(1)] FiniteStateMachine - Requesting WRITE of datafile 915061/915165/9c4c0780-6ac7-44a0-bd9c-7525afd80c50
2016-11-02 15:16:38,130 DEBUG [http-listener-2(1)] FiniteStateMachine - Requesting delay operations till Wed Nov 02 15:17:38 CET 2016
2016-11-02 15:16:38,131 DEBUG [http-listener-2(1)] FiniteStateMachine - Created marker /srv/ids/storage/no-icat/cache/marker/915167
2016-11-02 15:16:38,143 DEBUG [http-listener-2(1)] Transmitter - Sent jms message put 134.30.210.106
2016-11-02 15:16:38,144 DEBUG [http-listener-2(1)] LockManager$SingleLock - Released a lock on 915165.

* archive dataset

2016-11-02 15:15:07,166 INFO [http-listener-2(5)] IdsBean - New webservice request: archive investigationIds='null' datasetIds='915165' datafileIds='null'
2016-11-02 15:15:07,226 INFO [http-listener-2(5)] FiniteStateMachine - Requesting ARCHIVE of datafile 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159

* WRITE of datafile 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159

2016-11-02 15:15:08,364 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - deferredDfOpsQueue has 1 entries
2016-11-02 15:15:08,364 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159 WRITE_THEN_ARCHIVE_REQUESTED
2016-11-02 15:15:08,365 DEBUG [FSM Timer] LockManager - Acquired a SHARED lock on 915165.
2016-11-02 15:15:08,365 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - Adding 1 operations to be scheduled next time round
2016-11-02 15:15:08,366 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - Launch thread to process 1 writes
2016-11-02 15:15:08,692 DEBUG [Thread-69] DfWriter - Removed marker /srv/ids/storage/no-icat/cache/marker/915166
2016-11-02 15:15:08,692 DEBUG [Thread-69] DfWriter - Write of 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159 completed
2016-11-02 15:15:08,692 DEBUG [Thread-69] LockManager$SingleLock - Released a lock on 915165.

* FSM wait for lock

2016-11-02 15:15:13,369 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - deferredDfOpsQueue has 1 entries
2016-11-02 15:15:13,370 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159 ARCHIVE_REQUESTED
2016-11-02 15:15:13,371 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - Could not acquire lock on 915165, hold back ARCHIVE_REQUESTED
2016-11-02 15:17:38,378 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159 ARCHIVE_REQUESTED
2016-11-02 15:17:38,379 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - Could not acquire lock on 915165, hold back ARCHIVE_REQUESTED

* WRITE of datafile 915061/915165/9c4c0780-6ac7-44a0-bd9c-7525afd80c50

2016-11-02 15:17:38,377 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - deferredDfOpsQueue has 2 entries
2016-11-02 15:17:38,378 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - 915061/915165/9c4c0780-6ac7-44a0-bd9c-7525afd80c50 WRITE_REQUESTED
2016-11-02 15:17:38,378 DEBUG [FSM Timer] LockManager - Acquired a SHARED lock on 915165.
2016-11-02 15:17:38,379 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - Launch thread to process 1 writes
2016-11-02 15:17:38,381 DEBUG [Thread-70] DfWriter - Removed marker /srv/ids/storage/no-icat/cache/marker/915167
2016-11-02 15:17:38,381 DEBUG [Thread-70] DfWriter - Write of 915061/915165/9c4c0780-6ac7-44a0-bd9c-7525afd80c50 completed
2016-11-02 15:17:38,381 DEBUG [Thread-70] LockManager$SingleLock - Released a lock on 915165.

* cleanup, restore dataset

2016-11-02 15:18:08,298 INFO [http-listener-2(1)] IdsBean - New webservice request: restore investigationIds='null' datasetIds='915165' datafileIds='null'
2016-11-02 15:18:08,378 INFO [http-listener-2(1)] FiniteStateMachine - Requesting RESTORE of datafile 915061/915165/9c4c0780-6ac7-44a0-bd9c-7525afd80c50
2016-11-02 15:18:08,379 DEBUG [http-listener-2(1)] FiniteStateMachine - Requesting delay operations till Wed Nov 02 15:19:08 CET 2016
2016-11-02 15:18:08,379 INFO [http-listener-2(1)] FiniteStateMachine - Requesting RESTORE of datafile 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159

* cleanup, delete dataset

2016-11-02 15:18:28,421 INFO [http-listener-2(1)] IdsBean - New webservice request: delete investigationIds='null' datasetIds='915165' datafileIds='null'
2016-11-02 15:18:28,496 DEBUG [http-listener-2(1)] LockManager - Acquired a EXCLUSIVE lock on 915165.
2016-11-02 15:18:28,581 DEBUG [http-listener-2(1)] IdsBean - Delete physical file 915061/915165/9c4c0780-6ac7-44a0-bd9c-7525afd80c50 from main storage
2016-11-02 15:18:28,582 INFO [http-listener-2(1)] FiniteStateMachine - Requesting DELETE of datafile 915061/915165/9c4c0780-6ac7-44a0-bd9c-7525afd80c50
2016-11-02 15:18:28,595 DEBUG [http-listener-2(1)] IdsBean - Delete physical file 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159 from main storage
2016-11-02 15:18:28,638 INFO [http-listener-2(1)] FiniteStateMachine - Requesting DELETE of datafile 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159
2016-11-02 15:18:28,638 DEBUG [http-listener-2(1)] LockManager$SingleLock - Released a lock on 915165.
2016-11-02 15:18:28,648 DEBUG [http-listener-2(1)] Transmitter - Sent jms message delete 134.30.210.106

* DELETE of datafiles

2016-11-02 15:19:08,382 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - deferredDfOpsQueue has 2 entries
2016-11-02 15:19:08,382 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - 915061/915165/9c4c0780-6ac7-44a0-bd9c-7525afd80c50 DELETE_REQUESTED
2016-11-02 15:19:08,383 DEBUG [FSM Timer] LockManager - Acquired a EXCLUSIVE lock on 915165.
2016-11-02 15:19:08,383 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159 DELETE_REQUESTED
2016-11-02 15:19:08,383 DEBUG [FSM Timer] FiniteStateMachine$DfProcessQueue - Launch thread to process 2 deletes
2016-11-02 15:19:08,390 DEBUG [Thread-71] DfDeleter - Delete of 915061/915165/9c4c0780-6ac7-44a0-bd9c-7525afd80c50 completed
2016-11-02 15:19:08,417 DEBUG [Thread-71] DfDeleter - Delete of 915061/915165/1a2ee9ff-62ab-45ce-82a2-105e2455c159 completed
2016-11-02 15:19:08,417 DEBUG [Thread-71] LockManager$SingleLock - Released a lock on 915165.

# Local Variables:
# mode: org
# End:
